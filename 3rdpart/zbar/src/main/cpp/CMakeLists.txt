cmake_minimum_required(VERSION 3.10.2)

# 编译Release(Release Debug)
#set(CMAKE_BUILD_TYPE "Release")

# 编译警告
add_definitions(-Wno-format-security)
add_definitions(-Wno-multichar)
add_definitions(-D_ANDROID)
add_definitions(-DLIBDIR="c")
add_definitions(-DBUILDING_LIBICONV)
add_definitions(-DBUILDING_LIBCHARSET)
add_definitions(-DIN_LIBRARY)

# 源文件
set(ICONV_SRCS
        libiconv-1.15/lib/iconv.c
        libiconv-1.15/libcharset/lib/localcharset.c
        libiconv-1.15/lib/relocatable.c)

# 源文件
set(ZBAR_SRCS
        zbarjni.c
        zbar/img_scanner.c
        zbar/decoder.c
        zbar/image.c
        zbar/symbol.c
        zbar/convert.c
        zbar/config.c
        zbar/scanner.c
        zbar/error.c
        zbar/refcnt.c
        zbar/video.c
        zbar/video/null.c
        zbar/decoder/code128.c
        zbar/decoder/code39.c
        zbar/decoder/code93.c
        zbar/decoder/codabar.c
        zbar/decoder/databar.c
        zbar/decoder/ean.c
        zbar/decoder/i25.c
        zbar/decoder/qr_finder.c
        zbar/qrcode/bch15_5.c
        zbar/qrcode/binarize.c
        zbar/qrcode/isaac.c
        zbar/qrcode/qrdec.c
        zbar/qrcode/qrdectxt.c
        zbar/qrcode/rs.c
        zbar/qrcode/util.c)

# 头文件
include_directories("./")
include_directories("libiconv-1.15/include")
include_directories("libiconv-1.15/libcharset")
include_directories("libiconv-1.15/libcharset/include")
include_directories("zbar")
include_directories("include")
include_directories("include/zbar")

# 链接
add_library(
        zbarjni
        SHARED
        ${ZBAR_SRCS})

add_library(
        iconv
        SHARED
        ${ICONV_SRCS}
)
# so
target_link_libraries(zbarjni iconv)
